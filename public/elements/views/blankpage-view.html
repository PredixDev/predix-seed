<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/px-card/px-card.html">
<link rel="import" href="../../bower_components/google-apis/google-apis.html">
<link rel="import" href="../../bower_components/google-apis/google-maps-api.html">
<link rel="import" href="../../bower_components/google-map/google-map.html">
<link rel="import" href="../../bower_components/google-map/google-map-marker.html">
<link rel="import" href="../../bower_components/px-view-header/px-view-header.html">
<link rel="import" href="../../bower_components/px-typeahead/px-typeahead.html"/>
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html"/>
<link rel="import" href="../../bower_components/iron-icons/maps-icons.html"/>
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html"/>
<dom-module id="blankpage-view">

  <template>
	<style>
	  google-map {
 	   height: 400px;
 	 }
	</style>
    <iron-ajax auto id="vehicleMapReadings"
   	url="https://vds-ms.run.aws-usw02-pr.ice.predix.io/readings/Test"
    	handle-as="json"
    	on-response="_onResponse"
    	last-response="{{data}}">
    </iron-ajax>
    
    <px-card header-text="Track Vehicles {{data.readings.latitude}}">
    <label>Selected value : {{inputValue}}</label>
      <px-typeahead 
      max-suggestions="10" 
      placeholder="Enter Vehicle ID" 
      local-candidates='["7824","1258","7785","9731","7896","1659","1240","Test"]'
      input-value="{{inputValue}}">
      </px-typeahead>
    </px-card>
    <px-card header-text="Map {{data.readings.latitude}}" >
    <google-map disable-default-ui zoom="18" latitude="{{data.readings.latitude}}" longitude="{{data.readings.latitude}}">
	<google-map-marker latitude="{{data.readings.latitude}}" longitude="{{data.readings.longitude}}"
      title="{{data.readings.vehicleid}}" draggable="true" ></google-map-marker>
    </google-map>
    </px-card>
    
  </template>
  <script>
    Polymer({
      is: 'blankpage-view',
      properties: {
		  data :{
        type: Object
			}
	},
	_updateMapData: function(){
		this.async(function() {
              this.$.vehicleMapReadings.generateRequest();
            }, 15000);
	},
	_onResponse: function(){
		console.log("Maps: received response");
		this._updateMapData();		
	},
      ready: function() {
        console.log('blankpage-view ready()')
      }
    });
  </script>
</dom-module>
